{{ define "main" }}
<section id="hugo-content-wrapper">

    <!--
        - https://disaev.me/p/blog-engines-and-static-site-generators/#table-of-contents
        - https://ma.ttias.be/adding-a-sticky-table-of-contents-in-hugo-to-posts/
        - https://www.bram.us/2020/01/10/smooth-scrolling-sticky-scrollspy-navigation/
        - https://github.com/gohugoio/hugo/issues/1778#issuecomment-313895910
        - https://css-tricks.com/sticky-table-of-contents-with-scrolling-active-states/
        - https://www.cssscript.com/highly-customizable-table-contents-generator-tocbot/
        - https://www.jqueryscript.net/menu/fixed-table-contents-scrollspy.html

        - https://github.com/hakimel/css/tree/master/progress-nav
    -->


    <!-- Make a sidebar with the table of contents in-->
    {{ $has_headers := ge (findRE "<h[1-6].*?>(.|\n])+?</h[1-6]>" .Content | len) 2 }}
    {{ $toc_toggled := or (not (isset .Params "toc")) (eq .Params.toc true) }}
    {{ if and $has_headers $toc_toggled }}
        <div class="row">
            <!-- Add the sidebar as a column -->
            <section id="sidebar" class="col-auto">
                <div class="toc-wrapper torn-page">
                    <div id="sidebar-logo">
                        <img src="/assets/images/logo_new.png" alt="Our logo" style="width: 20vh;">
                    </div>
                    {{ .TableOfContents }}
                </div>
            </section>
            <!-- Add the content as a column -->
            <section id="hugo-content" class="col">
                <!-- Write the summary section -->
                {{ with .Params.Summary }}
                    <div class="torn-page">
                        <h1 class="subtitle">Summary</h1>
                        {{ . | markdownify }}
                    </div>
                {{ end }}

                <!-- Write the content from the markdown file -->
                <div class="torn-page">
                    {{ .Content }}
                </div>
            </section>
        </div>
    {{ else }}
        <!-- Don't add a table of contents - just do the normal container-->
        <section id="hugo-content" class="container-md">
            <div class="torn-page">
                {{ .Content }}
            </div>
        </section>
    {{ end }}

</section>
{{ end }}
